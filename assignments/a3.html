<!DOCTYPE html>
<html>
<head>
<meta charset='utf-8'>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
<link href='https://fonts.googleapis.com/css?family=Architects+Daughter' rel='stylesheet' type='text/css'>
<link rel="stylesheet" type="text/css" href="../stylesheets/stylesheet.css" media="screen" />
<link rel="stylesheet" type="text/css" href="../stylesheets/pygment_trac.css" media="screen" />
<link rel="stylesheet" type="text/css" href="../stylesheets/print.css" media="print" />
<link rel="stylesheet" type="text/css" href="../stylesheets/custom.css" media="screen" />

<!--[if lt IE 9]>
<script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
<![endif]-->

<title>COMP 20: Web Programming - Assignment 3</title>
</head>

<body>
<header>
<div class="inner">
<h1>Web Programming</h1>
<h2>Assignment 3: Where In The World......</h2>
<h2>Due: Thursday, November 13th at 11:59 PM</h2>
</div>
</header>

<div id="content-wrapper">
<div class="inner clearfix">
<section id="main-content">

<h2>Objectives</h2>
<ul>
<li>Develop a server-side web application using Heroku, Node.js, and the Express web framework.</li>
<li>Enable and use Cross-Origin Resource Sharing (CORS).</li>
<li>Read and write data to a MongoDB database.</li>
<li>Build JSON-based APIs.</li>
</ul>

<h2>Overview</h2>
<p>In <a href="a2.html">Assignment 2</a>, you sent your username, latitude, and longitude to a web application server (i.e., <code>http://chickenofthesea.herokuapp.com/</code>), and it responded with a gob of data (students and characters) in JSON format.  In this assignment, you will write a web application that is almost exactly like that used for Assignment 2, and deploy it to server(s).</p>

<p>Using Heroku, Node.js with the Express web framework, and MongoDB, you are to build a web application that maintains "location check-ins" (login, latitude, and longitude) for a long period of time.</p>

<h2>Data Description</h2>
<p>Your web application shall only work with one set of data: <code>locations</code>.  In MongoDB, a set of data is known as a <span class="stress">collection</span>.  If you are familiar with relational databases, a collection is analogous to a "table".  The collection contains a number of records, properly known as <span class="stress">documents</span>.  If you are familiar with relational databases, a document is analogous to a "row".  The data that must be stored in one document (or record) are:</p>
<ul>
<li><code>login</code> (a string) - A user's handle</li>
<li><code>latitude</code> (a floating point number) - The user's latitude</li>
<li><code>longitude</code> (a floating point number) - The user's longitude</li>
</ul>

<p>Each document will have the data field <code>_id</code> (the document's unique field, primary key) created automatically.</li>

<h2>Requirements</h2>
<p>Your web application shall have the following features:</p>
<ol>
<li>A <code>POST /sendLocation</code> API - Submits final score and grid for a terminated 2048 game --from any domain.  The mandatory fields and <span class="stress">exact field names</span> for submission to this API are <code>username</code>, <code>score</code>, and <code>grid</code>.  Successful submission of these three pieces of data shall result in one entry into the collection <code>scores</code> in Mongo. <span class="note">If a submission is missing any one of the data fields, do not insert new record into the database!</span>  Cross-origin resource sharing must be enabled for this API, else a 2048 game from another domain cannot send score.</li>
<li>A <code>GET /scores.json</code> API - Returns a JSON string (array of objects) for a specified player with the scores sorted in descending order.  The mandatory parameter for this API is <code>username</code>.  If <code>username</code> is empty, return empty JSON array <code>[]</code>.  Example: <code>/scores.json?username=mchow</code> returns the scores in descending order for me.  Example output: <code>
[{"username":"mchow","score":1344,"grid":"{\"size\":4,\"cells\":[[{\"x\":0,\"y\":0,\"value\":4,\"previousPosition\":{\"x\":0,\"y\":0},\"mergedFrom\":null},{\"x\":0,\"y\":1,\"value\":2,\"previousPosition\":{\"x\":0,\"y\":1},\"mergedFrom\":null},{\"x\":0,\"y\":2,\"value\":8,\"previousPosition\":{\"x\":0,\"y\":2},\"mergedFrom\":null},{\"x\":0,\"y\":3,\"value\":2,\"previousPosition\":{\"x\":0,\"y\":3},\"mergedFrom\":null}],[{\"x\":1,\"y\":0,\"value\":8,\"previousPosition\":{\"x\":1,\"y\":0},\"mergedFrom\":null},{\"x\":1,\"y\":1,\"value\":16,\"previousPosition\":{\"x\":1,\"y\":1},\"mergedFrom\":null},{\"x\":1,\"y\":2,\"value\":32,\"previousPosition\":{\"x\":1,\"y\":2},\"mergedFrom\":null},{\"x\":1,\"y\":3,\"value\":8,\"previousPosition\":{\"x\":2,\"y\":3},\"mergedFrom\":null}],[{\"x\":2,\"y\":0,\"value\":64,\"previousPosition\":{\"x\":2,\"y\":0},\"mergedFrom\":null},{\"x\":2,\"y\":1,\"value\":128,\"previousPosition\":{\"x\":2,\"y\":1},\"mergedFrom\":null},{\"x\":2,\"y\":2,\"value\":16,\"previousPosition\":{\"x\":2,\"y\":2},\"mergedFrom\":null},{\"x\":2,\"y\":3,\"value\":4,\"previousPosition\":{\"x\":3,\"y\":3},\"mergedFrom\":null}],[{\"x\":3,\"y\":0,\"value\":4,\"previousPosition\":{\"x\":3,\"y\":0},\"mergedFrom\":null},{\"x\":3,\"y\":1,\"value\":2,\"previousPosition\":{\"x\":3,\"y\":1},\"mergedFrom\":null},{\"x\":3,\"y\":2,\"value\":8,\"previousPosition\":{\"x\":3,\"y\":2},\"mergedFrom\":null},{\"x\":3,\"y\":3,\"value\":2,\"previousPosition\":null,\"mergedFrom\":null}]]}","created_at":"Tue Mar 25 2014 03:02:07 GMT+0000 (UTC)","_id":"5330f1afa83141020034d9a2"},{"username":"mchow","score":988,"grid":"{\"size\":4,\"cells\":[[{\"x\":0,\"y\":0,\"value\":4,\"previousPosition\":{\"x\":0,\"y\":0},\"mergedFrom\":null},{\"x\":0,\"y\":1,\"value\":32,\"previousPosition\":{\"x\":0,\"y\":1},\"mergedFrom\":null},{\"x\":0,\"y\":2,\"value\":8,\"previousPosition\":{\"x\":0,\"y\":2},\"mergedFrom\":null},{\"x\":0,\"y\":3,\"value\":2,\"previousPosition\":null,\"mergedFrom\":null}],[{\"x\":1,\"y\":0,\"value\":16,\"previousPosition\":{\"x\":1,\"y\":0},\"mergedFrom\":null},{\"x\":1,\"y\":1,\"value\":64,\"previousPosition\":{\"x\":1,\"y\":1},\"mergedFrom\":null},{\"x\":1,\"y\":2,\"value\":32,\"previousPosition\":{\"x\":1,\"y\":2},\"mergedFrom\":null},{\"x\":1,\"y\":3,\"value\":4,\"previousPosition\":{\"x\":0,\"y\":3},\"mergedFrom\":null}],[{\"x\":2,\"y\":0,\"value\":64,\"previousPosition\":{\"x\":2,\"y\":0},\"mergedFrom\":null},{\"x\":2,\"y\":1,\"value\":8,\"previousPosition\":{\"x\":2,\"y\":1},\"mergedFrom\":null},{\"x\":2,\"y\":2,\"value\":2,\"previousPosition\":{\"x\":2,\"y\":2},\"mergedFrom\":null},{\"x\":2,\"y\":3,\"value\":8,\"previousPosition\":{\"x\":1,\"y\":3},\"mergedFrom\":null}],[{\"x\":3,\"y\":0,\"value\":16,\"previousPosition\":{\"x\":3,\"y\":0},\"mergedFrom\":null},{\"x\":3,\"y\":1,\"value\":2,\"previousPosition\":{\"x\":3,\"y\":1},\"mergedFrom\":null},{\"x\":3,\"y\":2,\"value\":4,\"previousPosition\":{\"x\":3,\"y\":2},\"mergedFrom\":null},{\"x\":3,\"y\":3,\"value\":2,\"previousPosition\":{\"x\":2,\"y\":3},\"mergedFrom\":null}]]}","created_at":"Tue Mar 25 2014 03:03:52 GMT+0000 (UTC)","_id":"5330f2185f6efb02001866fd"}]</code>.  Cross-origin resource sharing must be enabled for this API else a 2048 game from another domain cannot retrieve scores.</li>
<li><code>/</code> - Home, the root, the index in HTML.  You may also use additional JavaScript and CSS, and you are free to design this page however you desire. Accessing this on a web browser shall display list of all the 2048 game scores for all players sorted in descending order by score (e.g., a table).  Usernames and game timestamps must be displayed in addition to the score.  Simply outputting JSON is unacceptable.</li>
</ol>

<h2>Security</h2>
<p>Please note that I did not mention a thing about security or error handling in the requirements.  Authentication to this web application is not required.  There is a reason for this, as you will see in Assignment 4.</p>

<h2>A Word on Getting Started</h2>
<p class="note">Please do not create and work on this assignment directly in your private GitHub repository as you will have a Git repo inside of a Git repo.  Your work will not be pushed to GitHub correctly if you do this. See "Submitting the Assignment."</p>

<h2>Getting Started</h2>

<h2>References You Will Need</h2>
<ol>
<li><a href="http://expressjs.com/api.html" target="_blank">The Express web framework API reference (offcial)</a></li>
<li><a href="http://docs.mongodb.org/manual/tutorial/getting-started/#getting-started-with-mongodb-development" target="_blank">Getting Started with MongoDB Development (official)</a></li>
<li><a href="https://devcenter.heroku.com/articles/getting-started-with-nodejs#using-mongodb" target="_blank">Getting Started with Node.js on Heroku - Using MongoDB</a>.</li>
<li><a href="http://mongodb.github.io/node-mongodb-native/" target="_blank">The Official MongoDB Node.JS Driver Documentation</a></li>
<li><a href="http://stackoverflow.com/questions/11181546/node-js-express-cross-domain-scripting" target="_blank">Node.js + Express + Cross-Domain Scripting (Stack Overflow)</a></li>
</ol>

<h2>Testing Your Web Application</h2>
<ul>
<li>Push and deploy your app to Heroku.</li>
<li>You will need to modify the game so that the final score and grid are sent to your web application.  You can hardcode the username (say, your initials).  You can use jQuery to do this (see hint above in "References").  What I did: I modified one of the JavaScript files in the <code>2048/js</code> folder and the <code>index.html</code> file.</li>
</ul>

<h2><span class="note">(IMPORTANT)</span> The <code>README</code> File</h2>
<p>Include a <code>README</code> file that describes the work. This description must:</p>
<ol>
<li>Identify what aspects of the work have been correctly implemented and what have not.</li>
<li>Identify anyone with whom you have collaborated or discussed the assignment.</li>
<li>Say approximately how many hours you have spent completing the assignment.</li>
<li>Be written in either text format (thus <code>README.txt</code>) or in Markdown (thus <code>README.md</code>). No other formats will be accepted.</li>
</ol>

<h2>Submitting the Assignment</h2>
<ol>
<li>Push and deploy your app to Heroku.</li>
<li>Complete the form at <a href="https://docs.google.com/forms/d/1tl-FmiJmyDxh0md9v66SkFSvkDjlfuEB10gshoZ2q7A/viewform" target="_blank">https://docs.google.com/forms/d/1r0LMVXAAO2kLL4mtixg3UhulCJOgSrHiekGBn2Ud9Fo/viewform</a>. <span class="note">You only need to complete this form once!</span></li>
<li>Push a ZIP (compressed file) of your web application to your private GitHub repository to a folder named <code>2048-gamecenter</code>.  <span class="note">No credit will be given for this assignment if you push a format other than ZIP (e.g., .7z, .rar)!</span>.  Please note that you must also have a <code>README</code> in the <code>2048-gamecenter</code> directory of your private GitHub repo!</li>
</ol>

<h2>Assessment</h2>
<ul>
<li>(5 points) The README</li>
<li>(5 points) Technical competency (e.g., use <a href="http://kotaku.com/5975610/the-exceptional-beauty-of-doom-3s-source-code" target="_blank">good programming practices</a> (including good variable names, code indentation); consistent and constant Git commits and pushes; write meaningful Git commit messages; have a <code>.gitignore</code> file in your repo)</li>
<li>(5 points) The <code>POST /submit.json</code> API as specified above</li>
<li>(5 points) The <code>GET /scores.json</code> API as specified above</li>
<li>(5 points) The index <code>/</code> as specified above</li>
</ul>

</section>
</div>
</div>

<script type="text/javascript">
var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
</script>
<script type="text/javascript">
try {
var pageTracker = _gat._getTracker("UA-582953-9");
pageTracker._trackPageview();
} catch(err) {}
</script>

</body>
</html>